# Experimental Flow: From Discovery to Validation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PHASE 1: DISCOVERY (HyperGrid)                       â”‚
â”‚                         Weeks 1-8 (~17 hours)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                             â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚   ABLATIONS     â”‚          â”‚   FACTORIALS    â”‚
           â”‚  (One at a time)â”‚          â”‚  (Interactions) â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                             â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚           â”‚           â”‚      â”‚                   â”‚
    â”Œâ”€â”€â”€â–¼â”€â”€â”€â”  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”  â”‚   â”Œâ”€â”€â”€â–¼â”€â”€â”€â”  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”
    â”‚Capacityâ”‚ â”‚Samplingâ”‚ â”‚  Loss â”‚  â”‚   â”‚Cap Ã— Sâ”‚ â”‚ S Ã— L â”‚
    â”‚110 runsâ”‚ â”‚110 runsâ”‚ â”‚105 runsâ”‚ â”‚   â”‚45 runsâ”‚ â”‚45 runsâ”‚
    â””â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”˜  â”‚   â””â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”˜
        â”‚          â”‚          â”‚       â”‚       â”‚          â”‚
        â”‚  Winner  â”‚  Winner  â”‚Winner â”‚       â”‚  Discoverâ”‚
        â”‚  Medium  â”‚  High    â”‚SubTB+ â”‚       â”‚Interactionsâ”‚
        â”‚  128Ã—4   â”‚  Temp    â”‚Entropyâ”‚       â”‚          â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                             â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   ANALYSIS & SELECTION      â”‚
                    â”‚        Week 9               â”‚
                    â”‚                             â”‚
                    â”‚  Select 2-3 best configs:   â”‚
                    â”‚  â€¢ Winner (best QDS)        â”‚
                    â”‚  â€¢ Diversity-focused (MCE)  â”‚
                    â”‚  â€¢ Baseline (control)       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  PHASE 2: VALIDATION (Real Tasks)                       â”‚
â”‚                       Weeks 10-12 (~18 hours)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                             â”‚
                    â”‚  Test 3 configs on 3 tasks  â”‚
                    â”‚  3 Ã— 3 Ã— 5 seeds = 45 runs  â”‚
                    â”‚                             â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                          â”‚                          â”‚
    â”Œâ”€â”€â”€â–¼â”€â”€â”€â”                  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”                  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”
    â”‚3-gramsâ”‚                  â”‚ Mols  â”‚                  â”‚  Seqs â”‚
    â”‚15 runsâ”‚                  â”‚15 runsâ”‚                  â”‚15 runsâ”‚
    â”‚~30 hrsâ”‚                  â”‚~60 hrsâ”‚                  â”‚~90 hrsâ”‚
    â””â”€â”€â”€â”¬â”€â”€â”€â”˜                  â””â”€â”€â”€â”¬â”€â”€â”€â”˜                  â””â”€â”€â”€â”¬â”€â”€â”€â”˜
        â”‚                          â”‚                          â”‚
        â”‚   Strong transfer?       â”‚   Partial transfer?      â”‚  Transfer?
        â”‚   âœ“ Discreteâ†’Discrete    â”‚   âš  More complex        â”‚  âš  Long
        â”‚                          â”‚     3 objectives         â”‚    sequences
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    TRANSFER ANALYSIS        â”‚
                    â”‚         Week 13             â”‚
                    â”‚                             â”‚
                    â”‚  â€¢ Compare rankings         â”‚
                    â”‚  â€¢ Measure transfer strengthâ”‚
                    â”‚  â€¢ Identify what transfers  â”‚
                    â”‚  â€¢ Create guidelines        â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚       PAPER SECTIONS        â”‚
                    â”‚                             â”‚
                    â”‚  5.1 Ablations (HyperGrid)  â”‚
                    â”‚  5.2 Factorials (HyperGrid) â”‚
                    â”‚  5.3 Validation (Real)      â”‚
                    â”‚  5.4 Guidelines             â”‚
                    â”‚                             â”‚
                    â”‚  Contributions:             â”‚
                    â”‚  âœ“ Systematic study         â”‚
                    â”‚  âœ“ Factor interactions      â”‚
                    â”‚  âœ“ Generalization proof     â”‚
                    â”‚  âœ“ Practical guidelines     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Key Insights

### Why This Flow Works

1. **HyperGrid is a Sandbox**
   - Fast iteration (24 min vs 2-6 hours)
   - Test 415 configurations in ~17 hours
   - Identify promising candidates

2. **Factorials Reveal Interactions**
   - Example: Small models + high temp may fail
   - Can't discover this with ablations alone
   - Prevents recommending bad combinations

3. **Validation Proves Generalization**
   - HyperGrid findings â†’ Real tasks
   - 3 domains of increasing complexity
   - Shows practical applicability

4. **Analysis Provides Value**
   - What transfers: "High temp always helps"
   - What doesn't: "3-obj needs different capacity"
   - Guidelines: "If task X, use config Y"

### Timeline

```
Weeks 1-2:  â–ˆâ–ˆâ–ˆâ–ˆ Capacity Ablation (HyperGrid)
Weeks 3-4:  â–ˆâ–ˆâ–ˆâ–ˆ Sampling Ablation (HyperGrid)
Weeks 5-6:  â–ˆâ–ˆâ–ˆâ–ˆ Loss Ablation (HyperGrid)
Week 7:     â–ˆâ–ˆ Capacity Ã— Sampling Factorial
Week 8:     â–ˆâ–ˆ Sampling Ã— Loss Factorial
            â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Week 9:     â”€â”€ Analysis & Selection
            â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Week 10:    â–ˆâ–ˆâ–ˆâ–ˆ 3-grams Validation
Week 11:    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ Molecules Validation
Week 12:    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ Sequences Validation
Week 13:    â–ˆâ–ˆâ–ˆâ–ˆ Transfer Analysis & Paper
```

### Budget Breakdown

**Phase 1 (Discovery)**:
- 415 runs Ã— 24 min = 166 hours sequential
- With 10 parallel jobs = **17 hours wall-clock**
- Cost: Low (simple task)

**Phase 2 (Validation)**:
- 45 runs Ã— 4 hr avg = 180 hours sequential
- With 10 parallel jobs = **18 hours wall-clock**
- Cost: Higher (complex tasks)

**Total**: ~35 hours wall-clock time (1.5 days)

### Risk Mitigation

If validation shows **weak transfer**:
- âœ… Still valuable: "HyperGrid findings don't fully transfer"
- âœ… Still publishable: Systematic ablations + factorials
- âœ… Still useful: "Task-specific tuning needed"
- âœ… New research: "What makes tasks different?"

If validation shows **strong transfer**:
- ğŸ‰ Strong claim: "Findings generalize across domains"
- ğŸ‰ High impact: Practitioners can use directly
- ğŸ‰ Novel: First to show MOGFN hyperparams transfer

### Expected Outcomes

**Most Likely**: Partial transfer
- Core principles work (high temp, medium capacity)
- Some task-specific tuning needed
- **Paper claim**: "Our approach provides excellent starting point with minor adaptation"

**Best Case**: Strong transfer
- HyperGrid winner is best on all tasks
- **Paper claim**: "Our findings generalize across domains"

**Worst Case**: Task-specific
- Different tasks need different configs
- **Paper claim**: "We characterize when each approach works best"

All outcomes are **publishable and valuable**!

## Files Created

### Core Experiment Configs
```
configs/
â”œâ”€â”€ ablations/
â”‚   â”œâ”€â”€ capacity_ablation.yaml
â”‚   â”œâ”€â”€ sampling_ablation.yaml
â”‚   â””â”€â”€ loss_ablation.yaml
â”œâ”€â”€ factorials/
â”‚   â”œâ”€â”€ capacity_sampling_2way.yaml
â”‚   â”œâ”€â”€ sampling_loss_2way.yaml
â”‚   â””â”€â”€ template_factorial.yaml
â””â”€â”€ validation/
    â”œâ”€â”€ validation_template.yaml
    â””â”€â”€ README.md
```

### Documentation
```
â”œâ”€â”€ EXPERIMENTAL_STRATEGY.md    # Complete timeline & budget
â”œâ”€â”€ EXPERIMENTAL_FLOW.md        # This file (visual overview)
â”œâ”€â”€ FACTORIAL_EXPERIMENTS_SUMMARY.md
â””â”€â”€ configs/
    â”œâ”€â”€ factorials/
    â”‚   â”œâ”€â”€ README.md
    â”‚   â””â”€â”€ QUICKSTART.md
    â””â”€â”€ validation/
        â””â”€â”€ README.md
```

### Execution Scripts
```
scripts/
â”œâ”€â”€ run_ablation_study.py           # Main ablation runner
â”œâ”€â”€ run_loss_ablation_group.py      # Loss ablation by group
â”œâ”€â”€ run_loss_ablation.sh            # Automated loss ablation
â””â”€â”€ (to create)
    â”œâ”€â”€ run_factorial_experiment.py # Factorial runner
    â””â”€â”€ run_validation.py           # Validation runner
```

## Summary

**You have**: A complete, rigorous experimental design
**Timeline**: 13 weeks
**Budget**: ~35 hours wall-clock (very reasonable!)
**Outcome**: High-impact paper with strong evidence

**Next step**: Complete HyperGrid experiments (Weeks 1-8)!
